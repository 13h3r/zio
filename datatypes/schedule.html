<html><head><title>: Schedule</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="ZIO contributors" /><meta name="description" content="Type-safe, composable asynchronous and concurrent programming for Scala" /><meta name="og:image" content="/scalaz-zio/img/poster.png" /><meta name="image" property="og:image" content="/scalaz-zio/img/poster.png" /><meta name="og:title" content=": Schedule" /><meta name="title" property="og:title" content=": Schedule" /><meta name="og:site_name" content="" /><meta name="og:url" content="https://scalaz.github.io/scalaz-zio/" /><meta name="og:type" content="website" /><meta name="og:description" content="Type-safe, composable asynchronous and concurrent programming for Scala" /><link rel="icon" type="image/png" href="/scalaz-zio/img/favicon.png" /><meta name="twitter:title" content=": Schedule" /><meta name="twitter:image" content="/scalaz-zio/img/poster.png" /><meta name="twitter:description" content="Type-safe, composable asynchronous and concurrent programming for Scala" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="512x512" href="/scalaz-zio/img/favicon.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/scalaz-zio/highlight/styles/default.css" /><link rel="stylesheet" href="/scalaz-zio/css/style.css" /><link rel="stylesheet" href="/scalaz-zio/css/palette.css" /><link rel="stylesheet" href="/scalaz-zio/css/codemirror.css" /><link rel="stylesheet" href="/scalaz-zio/css/override.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/scalaz-zio/" class="brand"><div class="brand-wrapper"><span></span></div></a></li>  <li><a href="/scalaz-zio/datatypes/" class="">Data Types</a> <ul class="sub_section"> <li><a href="/scalaz-zio/datatypes/fiber.html" class="">Fiber</a></li> <li><a href="/scalaz-zio/datatypes/fiberlocal.html" class="">FiberLocal</a></li> <li><a href="/scalaz-zio/datatypes/io.html" class="">IO</a></li> <li><a href="/scalaz-zio/datatypes/managed.html" class="">Managed</a></li> <li><a href="/scalaz-zio/datatypes/promise.html" class="">Promise</a></li> <li><a href="/scalaz-zio/datatypes/queue.html" class="">Queue</a></li> <li><a href="/scalaz-zio/datatypes/ref.html" class="">Ref</a></li> <li><a href="/scalaz-zio/datatypes/schedule.html" class=" active ">Schedule</a></li> <li><a href="/scalaz-zio/datatypes/semaphore.html" class="">Semaphore</a></li> <li><a href="/scalaz-zio/datatypes/stream.html" class="">Stream</a></li></ul></li>   </ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/scalaz/scalaz-zio"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/scalaz/scalaz-zio"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li></ul></div></div></div></div><div id="content" data-github-owner="scalaz" data-github-repo="scalaz-zio"><div class="content-wrapper"><section><h1 id="schedule">Schedule</h1>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">scalaz.zio._</span>
</code></pre></div></div>

<p>Schedules allow you to define and compose flexible recurrence schedules, which can be used to repeat actions, or retry actions in the event of errors. Schedules are used in the following functions:</p>

<ul>
  <li><strong>Repetition</strong>
    <ul>
      <li><code class="highlighter-rouge">IO#repeat</code> — Repeats an effect until the schedule is done.</li>
      <li><code class="highlighter-rouge">IO#repeatOrElse</code> — Repeats an effect until the schedule is done, with a fallback for errors.</li>
      <li><code class="highlighter-rouge">IO#repeatOrElse0</code> — Repeats an effect until the schedule is done, with a more powerful fallback for errors.</li>
    </ul>
  </li>
  <li><strong>Retries</strong>
    <ul>
      <li><code class="highlighter-rouge">IO#retry</code> – Retries an effect until it succeeds.</li>
      <li><code class="highlighter-rouge">IO#retryOrElse</code> — Retries an effect until it succeeds, with a fallback for errors.</li>
      <li><code class="highlighter-rouge">IO#retryOrElse0</code> — Retries an effect until it succeeds, with a more powerful fallback for errors.</li>
    </ul>
  </li>
</ul>

<p>Schedules define stateful, possibly effectful, recurring schedules of events, and compose in a variety of ways.</p>

<p>A <code class="highlighter-rouge">Schedule[A, B]</code> consumes input values of type <code class="highlighter-rouge">A</code> (errors in the case of <code class="highlighter-rouge">retry</code>, or values in the case of <code class="highlighter-rouge">repeat</code>), and based on these values and internal state, decides whether to recur or conclude. Every decision is accompanied by a (possibly zero) delay, indicating how much time before the next recurrence, and an output value of type <code class="highlighter-rouge">B</code>.</p>

<h1 id="base-schedules">Base Schedules</h1>

<p>A schedule that always recurs:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">forever</span> <span class="k">=</span> <span class="nc">Schedule</span><span class="o">.</span><span class="n">forever</span>
</code></pre></div></div>

<p>A schedule that never executes:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">never</span> <span class="k">=</span> <span class="nc">Schedule</span><span class="o">.</span><span class="n">never</span>
</code></pre></div></div>

<p>A schedule that recurs 10 times:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">upTo10</span> <span class="k">=</span> <span class="nc">Schedule</span><span class="o">.</span><span class="n">recurs</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
</code></pre></div></div>

<p>A schedule that recurs every 10 milliseconds:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">spaced</span> <span class="k">=</span> <span class="nc">Schedule</span><span class="o">.</span><span class="n">spaced</span><span class="o">(</span><span class="mf">10.</span><span class="n">milliseconds</span><span class="o">)</span>
</code></pre></div></div>

<p>A schedule that recurs using exponential backoff:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">exponential</span> <span class="k">=</span> <span class="nc">Schedule</span><span class="o">.</span><span class="n">exponential</span><span class="o">(</span><span class="mf">10.</span><span class="n">milliseconds</span><span class="o">)</span>
</code></pre></div></div>

<p>A schedule that recurs using fibonacci backoff:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">fibonacci</span> <span class="k">=</span> <span class="nc">Schedule</span><span class="o">.</span><span class="n">fibonacci</span><span class="o">(</span><span class="mf">10.</span><span class="n">milliseconds</span><span class="o">)</span>
</code></pre></div></div>

<h1 id="schedule-combinators">Schedule Combinators</h1>

<p>Applying random jitter to a schedule:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">jitteredExp</span> <span class="k">=</span> <span class="nc">Schedule</span><span class="o">.</span><span class="n">exponential</span><span class="o">(</span><span class="mf">10.</span><span class="n">milliseconds</span><span class="o">).</span><span class="n">jittered</span>
</code></pre></div></div>

<p>Modifies the delay of a schedule:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">boosted</span> <span class="k">=</span> <span class="nc">Schedule</span><span class="o">.</span><span class="n">spaced</span><span class="o">(</span><span class="mf">1.</span><span class="n">second</span><span class="o">).</span><span class="n">delayed</span><span class="o">(</span><span class="k">_</span> <span class="o">+</span> <span class="mf">100.</span><span class="n">milliseconds</span><span class="o">)</span>
</code></pre></div></div>

<p>Combines two schedules sequentially, by following the first policy until it ends, and then following the second policy:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">sequential</span> <span class="k">=</span> <span class="nc">Schedule</span><span class="o">.</span><span class="n">recurs</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span> <span class="n">andThen</span> <span class="nc">Schedule</span><span class="o">.</span><span class="n">spaced</span><span class="o">(</span><span class="mf">1.</span><span class="n">second</span><span class="o">)</span>
</code></pre></div></div>

<p>Combines two schedules through intersection, by recurring only if both schedules want to recur, using the maximum of the two delays between recurrences:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">expUpTo10</span> <span class="k">=</span> <span class="nc">Schedule</span><span class="o">.</span><span class="n">exponential</span><span class="o">(</span><span class="mf">1.</span><span class="n">second</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="nc">Schedule</span><span class="o">.</span><span class="n">recurs</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
</code></pre></div></div>

<p>Combines two schedules through union, by recurring if either schedule wants to
recur, using the minimum of the two delays between recurrences:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">expCapped</span> <span class="k">=</span> <span class="nc">Schedule</span><span class="o">.</span><span class="n">exponential</span><span class="o">(</span><span class="mf">100.</span><span class="n">milliseconds</span><span class="o">)</span> <span class="o">||</span> <span class="nc">Schedule</span><span class="o">.</span><span class="n">spaced</span><span class="o">(</span><span class="mf">1.</span><span class="n">second</span><span class="o">)</span>
</code></pre></div></div>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/scalaz-zio/highlight/highlight.pack.js"></script><script>hljs.configure({languages:['scala','java','bash']});
hljs.initHighlighting();
              </script><script>((window.gitter = {}).chat = {}).options = {
room: 'scalaz/scalaz-zio'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/scalaz-zio/js/main.js"></script></body></html>